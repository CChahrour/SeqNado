[← Back to main page](index.md)

# Pipeline Outputs

All SeqNado analysis results are organized within the `seqnado_output/` directory (or your custom output directory specified during configuration). This page describes the structure and types of files you can expect from your pipeline runs.

## General Output Structure

```
seqnado_output/{assay}/       # Assay-specific directory
├── seqnado_report.html       # Main interactive QC report (MultiQC)
├── protocol.txt              # Auto-generated data processing protocol
├── aligned/                  # Final BAM alignment files
├── bigwigs/                  # BigWig coverage tracks
├── peaks/                    # Peak calling results (ATAC, ChIP, CUT&Tag)
├── readcounts/               # Quantification files (RNA, CRISPR)
├── qc/                       # Quality control metrics
├── hub/                      # UCSC Genome Browser hub
├── heatmap/                  # DeepTools heatmap and metaplot PDFs
├── motifs/                   # Motif analysis results (if enabled)
├── tag_dirs/                 # HOMER tag directories
├── resources/                # Normalisation factors (spike-in)
├── genome_browser_plots/     # PlotNado visualisations (if configured)
├── geo_submission/           # GEO submission-ready files (if enabled)
├── methylation/              # Methylation calls (METH only)
├── variant/                  # VCF files (SNP only)
└── logs/                     # Process execution logs
```

!!! note
    Not all directories will be present for every assay. The exact output depends on your assay type and configuration options.

## Main Entry Point: SeqNado Report

The **`seqnado_report.html`** file is your primary analysis report, generated by MultiQC. It provides:

- **QC Summary**: FastQC, alignment statistics, and quality metrics
- **Sample Overview**: All samples displayed with key metrics
- **Peak Statistics**: Number of peaks called, genomic distribution (for applicable assays)
- **Library Complexity**: Duplication rates and unique read counts
- **Multi-Sample Comparisons**: Side-by-side QC metrics

A **`protocol.txt`** file is also generated, providing an auto-generated data processing protocol describing the steps performed.

!!! tip "Viewing the Report"
    Open `seqnado_report.html` in any modern web browser. No server required!

## Core Output Files

### Alignment Files (`aligned/`)

The BAM processing pipeline runs through several intermediate stages (sorting, blacklist filtering, duplicate removal, optional Tn5 shifting, quality filtering), but **all intermediate files are temporary and deleted after the pipeline completes**. Only the final processed BAM files are retained:

```
aligned/
├── {sample}.bam                   # Final processed BAM
└── {sample}.bam.bai              # BAM index
```

**Processing chain** (intermediates are removed automatically):

`raw → sorted → blacklist_regions_removed → duplicates_removed → shifted_for_tn5_insertion (ATAC/CUT&Tag only) → filtered → final`

**File Formats:**

- **BAM**: Binary alignment format, viewable with samtools/IGV
- **BAI**: Index files for rapid random access

### Coverage Tracks (`bigwigs/`)

Genome-wide signal tracks for visualisation, organised by tool and scaling method:

```
bigwigs/
├── {method}/                         # deeptools, homer, or bamnado
│   ├── unscaled/                     # Default unscaled tracks
│   │   └── {sample}.bigWig
│   ├── csaw/                         # CSAW-normalised (if enabled)
│   │   └── {sample}.bigWig
│   ├── spikein/                      # Spike-in normalised (if applicable)
│   │   └── {spikein_method}/
│   │       └── {sample}.bigWig
│   └── merged/                       # Consensus group merged tracks
│       └── {group}.bigWig
```

For **RNA-seq**, stranded bigwigs are produced with `_plus` and `_minus` suffixes:

```
bigwigs/{method}/unscaled/{sample}_plus.bigWig
bigwigs/{method}/unscaled/{sample}_minus.bigWig
```

**Pileup Tools:**

- **DeepTools**: `bamCoverage`-based tracks (supports all scaling methods)
- **HOMER**: `makeBigWig.pl`-based tracks (unscaled and merged only)
- **BamNado**: Custom pileup tool (unscaled and merged only)

**Scaling Methods:**

- **unscaled**: No normalisation applied
- **csaw**: CSAW-based normalisation (DeepTools only)
- **spikein**: Spike-in normalisation using external control DNA (DeepTools only)
- **merged**: Merged tracks across consensus groups

### Peak Calls (`peaks/`)

Peak calling results are simplified to 3-column BED files (chr, start, end):

```
peaks/
├── {method}/                          # macs2, macs3, homer, lanceotron, or seacr
│   ├── {sample}.bed                  # Individual sample peaks
│   └── merged/                        # Consensus peaks across replicates
│       └── {group}.bed
```

**Supported Peak Callers:**

- **MACS2**: Standard peak calling
- **MACS3**: Updated MACS peak calling
- **HOMER**: `findPeaks`-based peak calling
- **LanceOtron**: ML-based peak calling
- **SEACR**: Sparse Enrichment Analysis for CUT&RUN/CUT&Tag

**Peak File Format:**

- **BED**: Simple 3-column genomic coordinates (chr, start, end) extracted from each caller's native output

### Read Counts (`readcounts/`)

Quantification files for RNA-seq and CRISPR assays:

```
readcounts/
├── feature_counts/
│   └── read_counts.tsv               # Combined featureCounts output
└── salmon/                            # RNA-seq only
    └── salmon_counts.csv             # Combined Salmon quantification
```

### Quality Control (`qc/`)

Comprehensive QC metrics:

```
qc/
├── fastqc_raw/                        # FastQC reports on raw reads
│   ├── {sample}_1_fastqc.html        # Read 1 (paired-end)
│   └── {sample}_2_fastqc.html        # Read 2 (paired-end)
├── fastq_screen/                      # Contamination screening (if enabled)
│   ├── {sample}_1_screen.html
│   └── {sample}_2_screen.html
├── qualimap_bamqc/                    # BAM quality metrics (non-RNA assays)
│   └── {sample}/
│       └── qualimapReport.html
├── qualimap_rnaseq/                   # RNA-specific BAM QC (RNA assay only)
│   └── {sample}/
│       └── qualimapReport.html
├── alignment_stats.tsv               # Aggregated alignment statistics
├── library_complexity/                # Picard duplicate metrics
│   └── {sample}.metrics
└── frip_enrichment/                   # FRiP scores (if enabled, peak-calling assays)
    └── {method}/
        ├── {sample}_frip.pdf
        └── {sample}_frip.txt
```

!!! note
    For single-end data, FastQC and FastQ Screen files use `{sample}_fastqc.html` / `{sample}_screen.html` without the `_1`/`_2` suffix.

**QC Metrics Include:**

- Read quality scores per base position
- GC content distribution
- Adapter content
- Duplication rates
- Mapping statistics
- Coverage uniformity

### UCSC Genome Browser Hub (`hub/`)

Ready-to-load UCSC track hub generated by TracKNado:

```
hub/
└── {hub_name}.hub.txt                # Hub description file (default: seqnado_hub.hub.txt)
```

The hub structure (genomes.txt, trackDb.txt, etc.) is generated by TracKNado and includes links to your bigWig and other track files.

**Usage:**

1. Upload the `hub/` directory to a web-accessible location
2. Load in UCSC Genome Browser using the hub URL
3. Or use locally with IGV/other genome browsers

### Heatmaps (`heatmap/`)

DeepTools-generated heatmaps and metaplots (for assays with peak calling):

```
heatmap/
├── heatmap.pdf                        # Signal heatmap over regions of interest
└── metaplot.pdf                       # Average signal profile
```

### Motif Analysis (`motifs/`)

Motif enrichment analysis for peak-calling assays (if enabled):

```
motifs/
├── homer/                             # HOMER findMotifsGenome results
│   └── {peak_method}/
│       └── {sample}/
└── meme/                              # MEME-ChIP results (if enabled)
    └── {peak_method}/
        └── {sample}/
```

### Genome Browser Plots (`genome_browser_plots/`)

Publication-ready visualisations generated with PlotNado (if configured with plotting coordinates):
Publication-ready visualisations generated with PlotNado (if configured with plotting coordinates):

```
genome_browser_plots/
├── {region_name}.{format}             # Named regions from BED file
├── {chr}-{start}-{end}.{format}       # Unnamed regions use coordinates
└── template.toml                      # PlotNado configuration template
```

Output format can be `svg`, `png`, or `pdf` as configured.

### GEO Submission (`geo_submission/`)

Pre-formatted files for GEO/SRA submission (if enabled):

```
geo_submission/
├── samples_table.txt                  # Sample metadata (TSV format)
├── md5sums.txt                        # Combined checksums
├── raw_data_checksums.txt            # Checksums for raw FASTQ files
├── processed_data_checksums.txt      # Checksums for processed files
├── upload_instructions.txt           # Instructions for GEO upload
├── {sample}_1.fastq.gz              # Symlinks to raw FASTQ files
├── {sample}_2.fastq.gz
├── {sample}_{method}_{scale}.bigWig  # Renamed processed bigWig files
├── {sample}_{method}.bed             # Renamed peak files
└── {assay}/                          # Upload directory
```

## Assay-Specific Outputs

### ATAC-seq

ATAC-seq includes Tn5 insertion site correction during BAM processing and supports all peak callers. LanceOtron is the default peak caller.

**Key outputs:**

- `aligned/{sample}.bam` -- Tn5-shifted, filtered alignments
- `peaks/lanceotron/{sample}.bed` -- ML-based peak calls (default)
- `bigwigs/{method}/unscaled/{sample}.bigWig` -- Coverage tracks

**Key Metrics:**

- Fragment size distribution (nucleosome periodicity visible in QC report)
- FRiP (Fraction of Reads in Peaks) score (if enabled)

### ChIP-seq

Standard ChIP-seq with support for input controls:

**Key outputs:**

- `aligned/{sample}.bam` -- Final alignments
- `peaks/{method}/{sample}.bed` -- Peak calls (MACS2, HOMER, LanceOtron)
- `peaks/{method}/merged/{group}.bed` -- Consensus peaks
- `tag_dirs/{sample}/` -- HOMER tag directories
- `motifs/homer/{method}/{sample}/` -- Motif analysis (if enabled)

**Spike-in Normalisation** (if applicable):

- `resources/{method}/normalisation_factors.tsv` -- Scaling factors
- `bigwigs/deeptools/spikein/{spikein_method}/{sample}.bigWig` -- Normalised tracks

### CUT&Tag

CUT&Tag is a separate assay from ChIP-seq, with SEACR as the default peak caller and optional Tn5 shift correction:

**Key outputs:**

- `aligned/{sample}.bam` -- Final alignments (optionally Tn5-shifted)
- `peaks/seacr/{sample}.bed` -- SEACR peak calls (default)
- `bigwigs/{method}/unscaled/{sample}.bigWig` -- Coverage tracks

### RNA-seq

RNA-seq alignment uses STAR, with quantification by featureCounts and/or Salmon:

**Key outputs:**

- `aligned/{sample}.bam` -- STAR-aligned, processed BAM
- `readcounts/feature_counts/read_counts.tsv` -- Combined gene-level counts
- `readcounts/salmon/salmon_counts.csv` -- Salmon quantification (if enabled)
- `bigwigs/{method}/unscaled/{sample}_plus.bigWig` -- Stranded coverage (plus strand)
- `bigwigs/{method}/unscaled/{sample}_minus.bigWig` -- Stranded coverage (minus strand)
- `qc/qualimap_rnaseq/{sample}/qualimapReport.html` -- RNA-specific QC

### Methylation (METH)

Methylation calling uses MethylDackel, with support for both bisulfite and TAPS methods:

```
methylation/
├── methyldackel/
│   ├── {sample}_{genome}_CpG.bedGraph            # CpG methylation calls
│   ├── {sample}_{genome}_CpG_inverted.bedGraph    # TAPS-inverted calls (TAPS method only)
│   └── bias/
│       └── {sample}_{genome}.txt                  # M-bias data
├── methylation_conversion.tsv                     # Conversion rate statistics
└── methylation_conversion.png                     # Conversion rate plot
```

Samples are split by genome (reference vs spike-in) with split BAMs at `aligned/spikein/{sample}_{genome}.bam`.

### SNP / Variant Calling

Variant calling using bcftools:

```
variant/
├── {sample}.vcf.gz                    # Called variants
└── {sample}.anno.vcf.gz              # Annotated variants (if annotation enabled)
```

QC stats are produced at `qc/variant/{sample}.stats.txt`.

### Micro Capture-C (MCC)

Chromatin contact analysis:

```
mcc/
└── contacts/
    └── {group}/
        └── {group}.mcool              # Multi-resolution contact matrix
```

### CRISPR Screens

Guide RNA quantification with optional MAGeCK analysis:

```
readcounts/
├── feature_counts/
│   └── read_counts.tsv               # featureCounts guide counts (always produced)
└── mageck/                            # MAGeCK analysis (if enabled)
    ├── mageck_count.count.txt        # Raw guide counts
    ├── mageck_count.count_normalized.txt  # Normalised counts
    ├── mageck_count.countsummary.txt # Count summary
    ├── mageck_mle.gene_summary.txt   # MAGeCK MLE gene-level results
    ├── mageck_mle.sgrna_summary.txt  # MAGeCK MLE sgRNA-level results
    └── design_matrix.txt             # Design matrix used
```

## Accessing Your Results

### Command Line

```bash
# Navigate to output directory
cd seqnado_output/

# View main report
firefox {assay}/seqnado_report.html &

# List peaks
ls -lh {assay}/peaks/macs2/

# Load BAM in IGV
igv {assay}/aligned/{sample}.bam
```

### Opening Reports

The HTML reports can be opened directly in your browser:

```bash
# On local machine
open seqnado_output/chip/seqnado_report.html

# Via X11 forwarding on HPC
firefox seqnado_output/chip/seqnado_report.html &

# Transfer to local machine
scp -r user@hpc:path/to/seqnado_output/ ./
```

## Finding Specific Outputs

### Peak calling results
```bash
find seqnado_output/ -name "*.bed"
```

### Coverage tracks for visualisation
```bash
find seqnado_output/ -name "*.bigWig"
```

### QC HTML reports
```bash
find seqnado_output/ -name "*.html"
```

---

**See Also:**

- [Pipeline Overview](pipeline.md) - How outputs are generated
- [Tools Reference](tools.md) - Understanding tool-specific outputs